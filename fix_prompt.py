# fix_prompt.py
import base64
from pathlib import Path

# This is the entire correct prompt, encoded into a single, unbreakable string.
base64_encoded_prompt = "IyBDb25zdGl0dXRpb25hbCBUZXN0IEdlbmVyYXRpb24gVGFzawoKWW91IGFyZSBDT1JFJ3MgdGVzdCBnZW5lcmF0b3IuIFByb2R1Y2UgYSBTSU5HTEUsIENPTVBMRVRFLCBXT1JLSU5HIHB5dGVzdCBmaWxlLgoKIyMgTW9kdWxlIFVuZGVyIFRlc3QKKipGaWxlIHBhdGg6Kioge21vZHVsZV9wYXRofQoqKlRhcmdldCBjb3ZlcmFnZToqKiB7dGFyZ2V0X2NvdmVyYWdlfSUKCmBgYHB5dGhvbgp7bW9kdWxlX2NvZGV9CmBgYAoKKipHb2FsOioqIHtnb2FsfQoKLS0tIE1PQ0tJTkcgQU5EIERFUEVOREVOQ0lFUyAoQ1JJVElDQUwpIC0tLQotIFlvdU1VU1QgdXNlICd1bml0dGVzdC5tb2NrJyAoYE1vY2tgLCBgcGF0Y2hgLCBgQXN5bmNNb2NrYCkgdG8gaXNvbGF0ZSB0aGUgY29kZSB1bmRlciB0ZXN0LgotIERPIE5PVCB3cml0ZSB0ZXN0cyB0aGF0IG1ha2UgcmVhbCBuZXR3b3JrIGNhbGxzLCBjb25uZWN0IHRvIGEgZGF0YWJhc2UsIG9yIHJlYWQgZnJvbSB0aGUgZmlsZXN5c3RlbSB1bmxlc3MgYWJzb2x1dGVseSBuZWNlc3NhcnkgYW5kIHByb3Blcmx5IG1vY2tlZC4KLSBGb3Igc2VydmljZXMgb3IgZnVuY3Rpb25zIGltcG9ydGVkIGZyb20gb3RoZXIgbW9kdWxlcyAoZS5nLiwgYGdldF9zZXNzaW9uYCwgYFFkcmFudFNlcnZpY2VgKSwgeW91IE1VU1QgcGF0Y2ggdGhlbSBhdCB0aGVpciBzb3VyY2UuCgoqKkV4YW1wbGUgb2YgYSBnb29kLCBpc29sYXRlZCB0ZXN0IGZvciBhbiBhc3luYyBmdW5jdGlvbjoqKgpgYGBweXRob24KaW1wb3J0IHB5dGVzdApmcm9tIHVuaXR0ZXN0Lm1vY2sgaW1wb3J0IE1hZ2ljTW9jaywgcGF0Y2gsIEFzeW5jTW9jawojIEFzc3VtZSB0aGUgbW9kdWxlIHVuZGVyIHRlc3QgaXM6IHNyYy9mZWF0dXJlcy9zb21lX2ZlYXR1cmUvc2VydmljZS5weQojIGZyb20gc3JjLmZlYXR1cmVzLnNvbWVfZmVhdHVyZS5zZXJ2aWNlIGltcG9ydCBzb21lX2FzeW5jX2Z1bmN0aW9uCgojIEdvb2Q6IFBhdGNoIHRoZSBkZXBlbmRlbmN5IHdoZXJlIGl0IGlzIGRlZmluZWQKYHBhdGNoKCJzcmMuZmVhdHVyZXMuc29tZV9mZWF0dXJlLnNlcnZpY2UuZ2V0X3Nlc3Npb24iKQpAcHl0ZXN0Lm1hcmssYXN5bmNpbwphc3luYyBkZWYgdGVzdF9zb21lX2FzeW5jX2Z1bmN0aW9uX3dpdGhfbW9ja2VkX2RiKG1vY2tfZ2V0X3Nlc3Npb24pOgogICAgIyBBcnJhbmdlCiAgICBtb2NrX3Nlc3Npb24gPSBNYWdpY01vY2soKQogICAgbW9ja19zZXNzaW9uLmV4ZWN1dGUgPSB সেখানকারMvY2tNb2NrKCkgIyBNb2NrIGFzeW5jIG1ldGhvZHMKICAgIG1vY2tfZ2V0X3Nlc3Npb24ucmV0dXJuX3ZhbHVlLl9fYWVudGVyX18ucmV0dXJuX3ZhbHVlID0gbW9ja19zZXNzaW9uCiAgICAKICAgICMgQWN0CiAgICAjIHJlc3VsdCA9IGF3YWl0IHNvbWVfYXN5bmNfZnVuY3Rpb24oKQoKICAgICMgQXNzZXJ0CiAgICBtb2NrX3Nlc3Npb24uZXhlY3V0ZS5hc3NlcnRfYXdhaXRlZF9vbmNlKCkKICAgICMgYXNzZXJ0IHJlc3VsdCBpcyBub3QgTm9uZQpgYGAgCi0tLSBIQVJEIFJFUVVJUkVNRU5UUyAoTVVTVCBGT0xMT1cpIC0tLQoxKSBPdXRwdXQgT05MWSBQeXRob24gY29kZSwgd3JhcHBlZCBpbiBhIHNpbmdsZSBgYGBweXRob24gLi4uIGBgYCBibG9jay4gTm8gZXh0cmEgdGV4dC4KMikgSW5jbHVkZSBBTEwgbmVjZXNzYXJ5IGltcG9ydHMgKHB5dGVzdCwgdW5pdHRlc3QubW9jaywgdHlwaW5nLCBkYXRldGltZSwganNvbiwgb3MsIHBhdGhsaWIsIGV0Yy4pLgozKSBVc2UgcHJvcGVyIHB5dGVzdCBwYXR0ZXJucyBhbmQgZml4dHVyZXMuCjQpIFRlc3RzIG11c3QgYmUgcnVubmFibGUgaW1tZWRpYXRlbHkuCjUpIE5PIGV4cGxhbmF0aW9ucywgTk8gbWFya2Rvd24gb3V0c2lkZSBjb2RlIGJsb2Nrcy4KCiMjIEV4YW1wbGUgRm9ybWF0CmBgYHB5dGhvbgppbXBvcnQgcHl0ZXN0CmZyb20gdW5pdHRlc3QubW9jayBpbXBvcnQgTW9jaywgcGF0Y2gKCmRlZiB0ZXN0X2V4YW1wbGUoKToKICAgIGFzc2VydCBUcnVlCmBgYAoKTk9XIEdFTkVSQVRFIFRIRSBDT01QTEVURSBURVNUIEZJTEU6"

file_path = Path(".intent/mind/prompts/test_generator.prompt")

try:
    print("Decoding prompt content...")
    # THIS IS THE FIX: The incorrect .encode('ascii') call has been removed.
    decoded_prompt = base64.b64decode(base64_encoded_prompt).decode("utf-8")

    print(f"Writing correct prompt to: {file_path}")
    file_path.write_text(decoded_prompt, encoding="utf-8")

    print("\n✅ Success! The prompt file has been fixed.")
    print(
        "You can now delete this script (`rm fix_prompt.py`) and try the remediation command again."
    )

except Exception as e:
    print(f"\n❌ An error occurred: {e}")
    print(
        "Please ensure you are running this script from the root of the CORE project."
    )
