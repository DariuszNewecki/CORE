{
  "id": "standard_operations_general",
  "version": "1.2.0",
  "title": "Operations Standard â€“ General Operational Rules",
  "type": "policy",
  "status": "active",
  "owners": {
    "accountable": "Platform SRE",
    "responsible": [
      "Core Maintainer"
    ]
  },
  "review": {
    "frequency": "12 months"
  },
  "schema_id": "schema.policy",
  "policy_id": "a3e1b0c4-9f8d-4a7b-8c1d-6e5f4a3b2c1d",
  "purpose": "Unified operational governance for intent crates, integration workflows, canary deployments, self-healing routines, developer fastpaths, incident response, and runtime safety.\n",
  "rules": [
    {
      "id": "intent.schema_compliance",
      "scope": {
        "domains": [
          "intent_crates.validation"
        ]
      },
      "rationale": "Ensures that all change units follow the governed structure.",
      "enforcement": "error",
      "statement": "All intent crates MUST pass schema validation against the intent crate schema.",
      "check": {
        "engine": "workflow_gate",
        "params": {
          "check_type": "linter_compliance"
        }
      }
    },
    {
      "id": "intent.canary_required",
      "scope": {
        "domains": [
          "intent_crates.lifecycle"
        ]
      },
      "rationale": "Prevents breaking changes from hitting the main branch by testing in isolation.",
      "enforcement": "error",
      "statement": "All intent crates MUST pass a canary audit in an isolated environment before application.",
      "check": {
        "engine": "workflow_gate",
        "params": {
          "check_type": "canary_audit",
          "canary_passed": true
        }
      }
    },
    {
      "id": "intent.immutable_history",
      "scope": {
        "domains": [
          "intent_crates.lifecycle"
        ]
      },
      "rationale": "Prevents 'ghost changes' by ensuring the processing queue is always cleared and logged.",
      "enforcement": "error",
      "statement": "Processed intent crates MUST be moved to accepted or rejected and MUST NOT be modified in place.",
      "check": {
        "engine": "glob_gate",
        "params": {
          "check_type": "path_restriction",
          "patterns": [
            "work/crates/processing/**"
          ]
        }
      }
    },
    {
      "id": "integration.assign_ids_required",
      "rationale": "Stable UUIDs are the primary key for the Knowledge Graph.",
      "enforcement": "error",
      "statement": "Stable UUIDs MUST be assigned to all new public symbols before integration.",
      "check": {
        "engine": "workflow_gate",
        "params": {
          "check_type": "audit_history"
        }
      },
      "data": {
        "command": "core-admin fix ids --write"
      }
    },
    {
      "id": "integration.duplicate_ids_resolved",
      "rationale": "Duplicate IDs break semantic retrieval and system integrity.",
      "enforcement": "error",
      "statement": "Duplicate '# ID:' tags MUST be resolved before integration.",
      "check": {
        "engine": "knowledge_gate",
        "params": {
          "check_type": "duplicate_ids"
        }
      },
      "data": {
        "command": "core-admin fix duplicate-ids --write"
      }
    },
    {
      "id": "integration.knowledge_sync_required",
      "rationale": "Ensures the Mind (DB) is perfectly aligned with the Body (Code).",
      "enforcement": "error",
      "statement": "Codebase state MUST be synchronized with the database SSOT before integration.",
      "check": {
        "engine": "knowledge_gate",
        "params": {
          "check_type": "capability_assignment"
        }
      },
      "data": {
        "command": "core-admin manage database sync-knowledge --write"
      }
    },
    {
      "id": "integration.tests_must_pass",
      "rationale": "Guarantees functional integrity.",
      "enforcement": "error",
      "statement": "Full test suite MUST pass before integration.",
      "check": {
        "engine": "workflow_gate",
        "params": {
          "check_type": "test_verification"
        }
      },
      "data": {
        "command": "core-admin check tests"
      }
    },
    {
      "id": "integration.coverage_minimum",
      "rationale": "Enforces a minimum quality bar for all new logic.",
      "enforcement": "error",
      "statement": "Test coverage MUST meet or exceed the constitutional minimum (75%).",
      "check": {
        "engine": "workflow_gate",
        "params": {
          "check_type": "coverage_minimum"
        }
      },
      "data": {
        "command": "core-admin coverage check"
      }
    },
    {
      "id": "integration.audit_required",
      "rationale": "The final gate for constitutional alignment.",
      "enforcement": "error",
      "statement": "Full constitutional audit MUST pass before integration.",
      "check": {
        "engine": "workflow_gate",
        "params": {
          "check_type": "audit_history"
        }
      },
      "data": {
        "command": "core-admin check audit"
      }
    },
    {
      "id": "canary.abort_on_test_failure",
      "rationale": "Standard safety requirement for autonomous deployment. Includes audit errors as part of test verification.",
      "enforcement": "error",
      "statement": "Canary deployment MUST abort if any tests fail or audit errors are detected.",
      "check": {
        "engine": "workflow_gate",
        "params": {
          "check_type": "test_verification"
        }
      },
      "data": {
        "metric": "tests.failed == 0"
      }
    },
    {
      "id": "dev_fastpath.no_intent_changes",
      "scope": {
        "paths": [
          ".intent/**",
          "src/system/governance/**"
        ]
      },
      "rationale": "Fastpaths are for logic refinement, not constitutional changes.",
      "enforcement": "error",
      "statement": "Developer fastpath MUST NOT allow changes to intent or governance paths.",
      "check": {
        "engine": "glob_gate",
        "params": {
          "check_type": "path_restriction",
          "patterns": [
            ".intent/**"
          ]
        }
      }
    },
    {
      "id": "ir.triage_required",
      "rationale": "Ensures system failures are attended to within a governed timeframe.",
      "enforcement": "error",
      "statement": "All incidents MUST be triaged within 24 hours with severity and owner assigned.",
      "check": {
        "engine": "llm_gate",
        "params": {
          "instruction": "Verify adherence to: All incidents MUST be triaged within 24 hours with severity and owner assigned."
        }
      }
    },
    {
      "id": "ir.timeline_required",
      "rationale": "Traceability is required for postmortem analysis.",
      "enforcement": "warn",
      "statement": "A minimal incident timeline MUST be recorded.",
      "check": {
        "engine": "llm_gate",
        "params": {
          "instruction": "Verify adherence to: A minimal incident timeline MUST be recorded."
        }
      }
    },
    {
      "id": "ir.notifications_required",
      "rationale": "Escalation transparency.",
      "enforcement": "warn",
      "statement": "Maintainers MUST be notified for high and critical incidents.",
      "check": {
        "engine": "llm_gate",
        "params": {
          "instruction": "Verify adherence to: Maintainers MUST be notified for high and critical incidents."
        }
      }
    },
    {
      "id": "ir.postmortem_required",
      "rationale": "Enables the 'Self-Improving' loop by learning from critical failures.",
      "enforcement": "warn",
      "statement": "High and critical incidents REQUIRE a short postmortem with actions and owners.",
      "check": {
        "engine": "llm_gate",
        "params": {
          "instruction": "Verify adherence to: High and critical incidents REQUIRE a short postmortem with actions and owners."
        }
      }
    },
    {
      "id": "operations.runtime.env_vars_defined",
      "rationale": "Prevents runtime failures due to missing infrastructure secrets.",
      "enforcement": "error",
      "statement": "All required runtime environment variables MUST be set.",
      "scope": {
        "paths": [
          "src/**/*.py"
        ]
      },
      "check": {
        "engine": "ast_gate",
        "params": {
          "check_type": "forbidden_primitives",
          "forbidden": [
            "os.environ",
            "os.getenv"
          ]
        }
      },
      "data": {
        "exclusions": [
          "src/api/**",
          "src/body/cli/**",
          "src/mind/**",
          "src/shared/logger.py",
          "tests/**/*.py",
          "**/*_test.py",
          "**/test_*.py",
          "**/__init__.py"
        ]
      }
    }
  ],
  "removed_rules": {
    "note": "The following rule was removed as a duplicate of existing workflow_gate enforcement:",
    "canary.abort_on_audit_error": "Merged into canary.abort_on_test_failure. The workflow_gate test_verification check already includes audit validation via integration.audit_required, making this a duplicate check."
  },
  "intent_crates": {
    "description": "Change-management units governing modifications to system intent.",
    "schema": "intent_crate_schema.json",
    "lifecycle": [
      "proposed",
      "canary",
      "accepted",
      "rejected"
    ]
  },
  "integration_workflow": {
    "steps": [
      {
        "id": "linkage.assign_ids",
        "command": "core-admin fix ids --write"
      },
      {
        "id": "linkage.duplicate_ids",
        "command": "core-admin fix duplicate-ids --write"
      },
      {
        "id": "ssot.sync_knowledge",
        "command": "core-admin manage database sync-knowledge --write"
      },
      {
        "id": "quality.test_suite",
        "command": "core-admin check tests"
      },
      {
        "id": "quality.coverage_check",
        "command": "core-admin coverage check"
      },
      {
        "id": "governance.audit",
        "command": "core-admin check audit"
      }
    ]
  },
  "self_healing_routines": {
    "available": [
      {
        "id": "style.headers",
        "command": "core-admin fix headers --write"
      },
      {
        "id": "docs.docstrings",
        "command": "core-admin fix docstrings --write"
      },
      {
        "id": "quality.generate_tests",
        "command": "core-admin coverage remediate",
        "trigger": "coverage < 75%"
      }
    ]
  },
  "canary": {
    "enabled": true,
    "environments": [
      "development",
      "staging"
    ],
    "paths": [
      "src/**",
      "cli/**",
      "agents/**"
    ]
  },
  "dev_fastpath": {
    "thresholds": {
      "max_changed_files": 20
    },
    "required_checks": [
      "syntax",
      "linter",
      "formatter"
    ]
  },
  "incident_response": {
    "severity_levels": [
      "low",
      "medium",
      "high",
      "critical"
    ]
  },
  "additionalProperties": false
}
