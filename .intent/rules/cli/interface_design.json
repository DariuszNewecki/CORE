{
    "$schema": "META/rule_document.schema.json",
    "kind": "rule_document",
    "metadata": {
        "id": "rules.cli.interface_design",
        "title": "CLI Interface Design Enforcement",
        "version": "2.0.0",
        "authority": "constitution",
        "phase": "load",
        "status": "active"
    },
    "rules": [
        {
            "id": "cli.resource_first",
            "statement": "CLI commands MUST follow 'resource action [flags]' pattern (depth=2), except admin namespace which may use depth=3.",
            "enforcement": "blocking",
            "authority": "constitution",
            "phase": "load",
            "rationale": "Resource-first design maps to user mental models and prevents architecture leakage into UX."
        },
        {
            "id": "cli.no_layer_exposure",
            "statement": "Resource names MUST NOT be 'mind', 'body', 'will', 'manage', 'check', or 'fix' as these expose internal architecture.",
            "enforcement": "blocking",
            "authority": "constitution",
            "phase": "load",
            "rationale": "Internal architecture layers should not be visible in user-facing commands.",
            "check": {
                "engine": "knowledge_gate",
                "params": {
                    "forbidden_resources": [
                        "mind",
                        "body",
                        "will",
                        "manage",
                        "check",
                        "fix"
                    ]
                }
            }
        },
        {
            "id": "cli.standard_verbs",
            "statement": "Action names SHOULD use standard verbs from the approved architectural vocabulary.",
            "enforcement": "reporting",
            "authority": "constitution",
            "phase": "load",
            "rationale": "Consistent vocabulary improves discoverability and reduces cognitive load.",
            "check": {
                "engine": "knowledge_gate",
                "params": {
                    "allowed_verbs": [
                        "actions",
                        "analyze",
                        "approve",
                        "audit",
                        "audit-duplicates",
                        "baseline",
                        "chat",
                        "check-ui",
                        "clarity",
                        "cleanup",
                        "complexity",
                        "coverage",
                        "create",
                        "delete",
                        "docs",
                        "docstrings",
                        "drift",
                        "execute",
                        "export",
                        "export-context",
                        "fix-atomic",
                        "fix-ids",
                        "forensics",
                        "format",
                        "format-imports",
                        "get",
                        "generate",
                        "info",
                        "inspect",
                        "lint",
                        "list",
                        "logging",
                        "migrate",
                        "new",
                        "onboard",
                        "patterns",
                        "query",
                        "refactor-settings",
                        "refusals",
                        "reject",
                        "rebuild",
                        "resolve-duplicates",
                        "rewire-imports",
                        "score",
                        "self-check",
                        "set",
                        "show",
                        "stats",
                        "status",
                        "suggest",
                        "summary",
                        "sync",
                        "sync-code",
                        "sync-registry",
                        "tag",
                        "test",
                        "test-stability",
                        "traces",
                        "validate",
                        "validate-env",
                        "verify"
                    ]
                }
            }
        },
        {
            "id": "cli.dangerous_explicit",
            "statement": "Commands that mutate state MUST require --write flag or interactive confirmation.",
            "enforcement": "blocking",
            "authority": "constitution",
            "phase": "runtime",
            "rationale": "Prevents accidental data loss and provides audit trail for mutations."
        },
        {
            "id": "cli.async_execution",
            "statement": "All async commands MUST be wrapped with @core_command decorator to handle event loop execution.",
            "enforcement": "blocking",
            "authority": "code",
            "phase": "execution",
            "rationale": "Ensures proper async/await handling and prevents RuntimeWarning errors."
        },
        {
            "id": "cli.discovery_strict",
            "statement": "CLI resource discovery MUST fail-fast on module load errors unless CORE_DEV_MODE=1.",
            "enforcement": "blocking",
            "authority": "code",
            "phase": "load",
            "rationale": "Prevents silent failures and ensures all registered commands are functional."
        },
        {
            "id": "cli.help_required",
            "statement": "Every command MUST provide help text and usage examples.",
            "enforcement": "reporting",
            "authority": "policy",
            "phase": "audit",
            "rationale": "Self-documenting CLI improves usability and reduces support burden."
        }
    ]
}
