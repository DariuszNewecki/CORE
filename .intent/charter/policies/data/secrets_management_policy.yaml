policy_id: ffb2dcec-3a90-45e6-aea7-691dd3b339b3
id: secrets_management_policy
version: "1.0.0"
title: "Secrets Management Policy"
status: active
purpose: >
  Define rules for handling secrets to prevent accidental exposure in source code,
  logs, and outputs.
scope:
  applies_to: [code, ci, logs]
owners:
  primary: "Security Lead"
  reviewers: ["Core Maintainer"]
review:
  frequency: "12 months"

rules:
  - id: no_hardcoded_secrets
    statement: Source code MUST NOT contain hardcoded secrets (API keys, passwords). Use environment variables.
    enforcement: error
    detection:
      patterns:
        - "(A|B|S|G)K[0-9A-Za-z]{30,}" # Common API key patterns
        - 'password\s*[:=]\s*[''""].+[''""]'
      exclude:
        - "tests/**"
        - ".env.example"

  - id: redact_secrets_in_logs
    statement: Logs and telemetry MUST redact sensitive data (tokens, keys, passwords) before persistence.
    enforcement: warn

checklist:
  - Auditor scans for hardcoded secret patterns and fails the build if found outside excluded paths.
  - Periodic manual review of logs to ensure redaction is working as expected.
