# .intent/charter/constitution/authority.yaml
version: "3.0.0"
type: "constitutional_authority"
domain: "authority"

principles:
  constitutional_modifications:
    statement: "Modifications to constitutional documents require human approval"
    rationale: "Preserves human authority over governance rules and prevents AI self-amendment"
    scope:
      - ".intent/charter/constitution/**"
    enforcement:
      method: "path_match"
      parameters:
        patterns: [".intent/charter/constitution/**"]
        action: "block_autonomous"

  critical_path_modifications:
    statement: "Modifications to governance and core infrastructure require human approval"
    rationale: "Protects system integrity and prevents cascading failures"
    scope:
      - "src/mind/governance/**"
      - "src/body/core/database.py"
      - "src/will/orchestration/intent_guard.py"
    enforcement:
      method: "path_match"
      parameters:
        patterns: ["src/mind/governance/**", "src/body/core/database.py", "src/will/orchestration/intent_guard.py"]
        action: "require_human_approval"

  high_risk_operations:
    statement: "Operations with architectural or security impact require human approval"
    rationale: "Prevents irreversible changes and maintains system security"
    scope:
      - "schema_migration"
      - "production_deployment"
      - "external_api_integration"
      - "cryptographic_operations"
    enforcement:
      method: "action_classification"
      parameters:
        actions_prohibited: ["schema_migration", "production_deployment", "external_api_integration", "cryptographic_operations"]
        require: "human_approval"

  autonomous_code_quality:
    statement: "Code quality improvements are allowed autonomously"
    rationale: "Low-risk, high-frequency operations safe for automation"
    scope:
      - "fix_docstring"
      - "format_code"
      - "fix_lint"
      - "add_type_hints"
    enforcement:
      method: "action_classification"
      parameters:
        actions_allowed: ["fix_docstring", "format_code", "fix_lint", "add_type_hints"]
        require: "validation_only"

  autonomous_documentation:
    statement: "Documentation updates are allowed autonomously"
    rationale: "Documentation changes are easily reversible and low-risk"
    scope:
      - "docs/**"
      - "README.md"
      - "*.md"
    enforcement:
      method: "path_match"
      parameters:
        patterns: ["docs/**", "README.md", "*.md"]
        action: "allow_autonomous"

  autonomous_testing:
    statement: "Test execution and generation are allowed autonomously"
    rationale: "Testing improves quality without modifying production code"
    scope:
      - "run_tests"
      - "generate_tests"
      - "measure_coverage"
    enforcement:
      method: "action_classification"
      parameters:
        actions_allowed: ["run_tests", "generate_tests", "measure_coverage", "create_fixtures"]
        require: "validation_only"

  autonomous_analysis:
    statement: "Read-only analysis operations are allowed autonomously"
    rationale: "Analysis has no side effects and provides valuable insights"
    scope:
      - "scan_violations"
      - "generate_report"
      - "build_knowledge_graph"
      - "compute_metrics"
    enforcement:
      method: "action_classification"
      parameters:
        actions_allowed: ["scan_violations", "generate_report", "build_knowledge_graph", "compute_metrics"]
        require: "audit_only"

  conditional_code_generation:
    statement: "Code generation allowed only when matching architectural patterns"
    rationale: "Ensures generated code follows established standards"
    scope:
      - "generate_crud"
      - "generate_service"
      - "generate_test"
    enforcement:
      method: "pattern_validation"
      parameters:
        require_pattern_match: true
        pattern_source: ".intent/charter/standards/architecture/"
        on_violation: "block_execution"

  conditional_refactoring:
    statement: "Refactoring allowed only when preserving behavior"
    rationale: "Prevents breaking changes during autonomous operations"
    scope:
      - "extract_method"
      - "rename_symbol"
      - "inline_variable"
    enforcement:
      method: "behavioral_verification"
      parameters:
        require_tests_pass: true
        require_no_behavioral_change: true
        on_violation: "block_execution"
