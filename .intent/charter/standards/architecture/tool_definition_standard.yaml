# .intent/charter/standards/architecture/tool_definition_standard.yaml
id: standard_architecture_tool_definition
version: "1.0.0"
title: "Architecture Standard â€“ Tool Definitions"
type: "standard_architecture"
status: active

owners:
  accountable: "AI Architecture Lead"
  responsible:
    - "Core Maintainer"

review:
  frequency: "12 months"

schema_id: "standard.architecture.tool_definitions"

purpose: >
  Defines how Python CLI commands and Atomic Actions are transformed into
  JSON Schema definitions for LLM tool calling. Ensures Agents hallucinate
  arguments less often by providing strict type bounds.

rules:
  - id: tools.explicit_return_contract
    statement: "Tool definitions MUST describe the ActionResult schema, not just 'string'."
    enforcement: error
    rationale: "LLMs need to know they will receive a JSON object with 'ok' and 'data' fields."

  - id: tools.type_mapping_strictness
    statement: "Python types MUST map to the most specific JSON Schema type possible."
    enforcement: error

type_mapping:
  primitives:
    int: "integer"
    float: "number"
    bool: "boolean"
    str: "string"
    Path: "string (format: file-path)"
    UUID: "string (format: uuid)"

  complex:
    "List[T]":
      type: "array"
      items: "mapped type of T"
    "Optional[T]":
      type: "mapped type of T"
      nullable: true
    "Enum":
      type: "string"
      enum: ["values..."]

schema_transformation:
  name:
    source: "Function name"
    transform: "snake_case, prefixed with domain if ambiguous"
  description:
    source: "Docstring"
    requirement: "Must include side-effect warnings if @atomic_action(impact!=read-only)"
  parameters:
    source: "Type hints"
    handling:
      - "Exclude 'self', 'cls'"
      - "Exclude 'context' if injected by runtime"
      - "Mark arguments with no default value as required"

action_result_schema:
  description: "The universal return format for all Core tools."
  structure: |
    {
      "type": "object",
      "properties": {
        "ok": { "type": "boolean", "description": "Did the operation succeed?" },
        "data": { "type": "object", "description": "Structured return data" },
        "error": { "type": "string", "description": "Error message if ok=false" }
      }
    }
