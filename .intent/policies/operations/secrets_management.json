{
  "id": "standard_operations_secrets",
  "version": "1.0.5",
  "title": "Operations Standard \u2013 Secrets Management",
  "type": "standard_operations",
  "status": "active",
  "owners": {
    "accountable": "Security Lead",
    "responsible": [
      "Platform SRE"
    ]
  },
  "review": {
    "frequency": "6 months"
  },
  "schema_id": "policy.structure",
  "purpose": "Defines how secrets are accessed, injected, and rotated. Ensures that agents, logs, and reasoning layers never observe raw secret values.\n",
  "rules": [
    {
      "id": "secrets.no_raw_access",
      "detection": {
        "method": "ast_call_scan",
        "patterns": [
          "os\\.environ\\[",
          "os\\.environ\\.get\\(",
          "os\\.getenv\\("
        ]
      },
      "mitigation": "Secrets MUST be referenced indirectly (e.g. 'env:OPENAI_API_KEY').",
      "rationale": "Strengthens system governance regarding secrets.no_raw_access.",
      "enforcement": "error",
      "statement": "Agents, tools, and logs MUST NEVER contain raw secret values.",
      "check": {
        "engine": "llm_gate",
        "params": {
          "instruction": "Verify adherence to: Agents, tools, and logs MUST NEVER contain raw secret values."
        }
      }
    },
    {
      "id": "secrets.provider_abstraction",
      "detection": {
        "method": "ast_call_scan",
        "patterns": [
          "SecretProvider"
        ]
      },
      "rationale": "Strengthens system governance regarding secrets.provider_abstraction.",
      "enforcement": "error",
      "statement": "All secret retrieval MUST go through the SecretsService abstraction.",
      "check": {
        "engine": "llm_gate",
        "params": {
          "instruction": "Verify adherence to: All secret retrieval MUST go through the SecretsService abstraction."
        }
      }
    },
    {
      "id": "secrets.no_hardcoded_secrets",
      "detection": {
        "method": "ast_call_scan",
        "patterns": [
          "API_KEY\\s*=\\s*[\\\"']",
          "SECRET\\s*=\\s*[\\\"']",
          "PASSWORD\\s*=\\s*[\\\"']"
        ]
      },
      "rationale": "Strengthens system governance regarding secrets.no_hardcoded_secrets.",
      "enforcement": "error",
      "statement": "Source code MUST NOT contain hardcoded secret material.",
      "check": {
        "engine": "llm_gate",
        "params": {
          "instruction": "Verify adherence to: Source code MUST NOT contain hardcoded secret material."
        }
      }
    },
    {
      "id": "secrets.rotation_autonomy",
      "detection": {
        "method": "ast_call_scan",
        "patterns": [
          "API_KEY\\s*=\\s*[\\\"']",
          "SECRET\\s*=\\s*[\\\"']",
          "PASSWORD\\s*=\\s*[\\\"']"
        ]
      },
      "rationale": "Rotation tools must return status only, never secret data.",
      "enforcement": "error",
      "statement": "Agents MAY trigger secret rotation but MUST NOT observe the new value.",
      "check": {
        "engine": "llm_gate",
        "params": {
          "instruction": "Verify adherence to: Agents MAY trigger secret rotation but MUST NOT observe the new value."
        }
      }
    }
  ],
  "secret_reference_format": {
    "syntax": "{provider}:{key_name}",
    "examples": [
      "env:DATABASE_URL",
      "vault:production/llm/openai_key"
    ]
  },
  "secret_injection": {
    "mechanism": "Runtime environment injection",
    "steps": [
      "Agent requests execution.",
      "Orchestrator resolves required secret references.",
      "SecretsService retrieves secret values.",
      "Values injected into tool process environment.",
      "Tool accesses value via runtime environment only."
    ],
    "guarantees": [
      "LLM never sees secret value.",
      "Secrets never appear in prompts, logs, or context packages."
    ]
  },
  "secret_rotation": {
    "trigger": "Authentication or authorization failure detected.",
    "action": "core-admin manage secrets rotate <key_id>",
    "behavior": [
      "Agent requests rotation.",
      "SecretsService invokes SecretProvider.",
      "Provider generates and stores new secret.",
      "Tool returns success/failure status only."
    ]
  },
  "additionalProperties": false
}
