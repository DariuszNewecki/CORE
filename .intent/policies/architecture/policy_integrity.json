{
  "id": "standard_policy_integrity",
  "version": "2.0.0",
  "title": "Policy Integrity & Cross-Reference Standards",
  "type": "policy",
  "status": "active",
  "owners": {
    "accountable": "Constitutional Governance",
    "responsible": [
      "Core Maintainer"
    ]
  },
  "review": {
    "frequency": "12 months"
  },
  "schema_id": "meta.policy",
  "purpose": "Establishes rules for maintaining constitutional policy integrity, including how to handle duplicate rule IDs, cross-references between policies, and partial enforcement tracking.\nSupports the \"High-Level + Implementation\" pattern where the same rule ID appears in multiple files intentionally to link governance statements with technical specifications.\n",
  "rules": [
    {
      "id": "policy.duplicate_rule_id_consistency",
      "category": "governance",
      "rationale": "Duplicate rule IDs are ALLOWED for intentional cross-referencing (e.g.,\nhigh-level governance statement in one file, detailed implementation in\nanother). However, they must agree on enforcement level to avoid ambiguity\nand conflicting governance outcomes.\n",
      "enforcement": "error",
      "statement": "When the same rule ID appears in multiple charter files, all instances MUST have consistent enforcement level after normalization.\n",
      "check": {
        "engine": "llm_gate",
        "params": {
          "instruction": "Verify adherence to: When the same rule ID appears in multiple charter files, all instances MUST have consistent enforcement level after normalization.\n"
        }
      }
    },
    {
      "id": "policy.cross_reference_documented",
      "category": "governance",
      "rationale": "Without explicit linkage, duplicate rule IDs look accidental. The loader,\nauditor, and human reviewers must be able to tell whether a duplicate is\na governance statement, an implementation specification, or the canonical\ndefinition.\n",
      "enforcement": "warning",
      "statement": "When a rule ID appears in multiple files, each occurrence MUST declare its role in the cross-reference relationship OR explicitly declare itself as the canonical definition.\n",
      "check": {
        "engine": "llm_gate",
        "params": {
          "instruction": "Verify adherence to: When a rule ID appears in multiple files, each occurrence MUST declare its role in the cross-reference relationship OR explicitly declare itself as the canonical definition.\n"
        }
      }
    },
    {
      "id": "policy.partial_enforcement_declared",
      "category": "governance",
      "rationale": "Transparent partial enforcement prevents false confidence in governance\ncoverage and helps prioritize checker development. This enables reporting\n\"partially_enforced\" instead of binary declared/enforced.\n",
      "enforcement": "error",
      "statement": "Rules with incomplete checker implementation MUST declare which aspects are enforced and which are not implemented.\n",
      "check": {
        "engine": "llm_gate",
        "params": {
          "instruction": "Verify adherence to: Rules with incomplete checker implementation MUST declare which aspects are enforced and which are not implemented.\n"
        }
      }
    }
  ],
  "normalization": {
    "enforcement_levels": {
      "allowed": [
        "error",
        "warn",
        "info"
      ],
      "mapping": {
        "severity.ERROR": "error",
        "severity.WARN": "warn",
        "severity.INFO": "info",
        "enforcement.warning": "warn",
        "enforcement.warn": "warn",
        "enforcement.error": "error",
        "enforcement.info": "info"
      }
    },
    "comparison_rule": "Compare normalized enforcement per rule ID across all occurrences"
  },
  "cross_reference_contract": {
    "required_one_of": [
      "cross_reference",
      "canonical_definition"
    ],
    "fields": {
      "role": {
        "allowed": [
          "governance_statement",
          "implementation_detail",
          "domain_variant",
          "mirror"
        ]
      },
      "related_file": {
        "description": "Relative path to the related charter file"
      },
      "related_rule_id": {
        "description": "Rule ID in the related file (usually identical)"
      },
      "note": {
        "description": "Short explanation of relationship"
      }
    }
  },
  "enforcement_aspects_contract": {
    "required_fields": [
      "name",
      "status"
    ],
    "status_values": [
      "enforced",
      "not_implemented",
      "planned",
      "deprecated"
    ],
    "optional_fields": [
      "checker",
      "reason",
      "evidence"
    ]
  },
  "enforcement_strategy": {
    "checker": "DuplicateRuleIdCheck",
    "checks": [
      "Scan all .yaml files under .intent/charter/",
      "Index rule occurrences by rule id",
      "Normalize enforcement level (support legacy severity/enforcement spellings)",
      "Enforce consistency of normalized enforcement for duplicates",
      "Require cross-reference contract or canonical definition for duplicates",
      "If enforcement_aspects present, validate against contract"
    ],
    "blocking_conditions": [
      "Duplicate rule IDs with conflicting normalized enforcement (error)"
    ],
    "non_blocking_findings": [
      "Duplicate rule IDs missing cross-reference or canonical definition (warn)"
    ]
  },
  "examples": {
    "duplicate_consistency": {
      "correct": "# agent_governance.yaml\n- id: agent.execution.no_unverified_code\n  enforcement: error\n\n# code_execution.yaml (legacy tolerated)\n- id: agent.execution.no_unverified_code\n  severity: ERROR  # normalized to 'error' -> consistent\n",
      "incorrect": "# File A\n- id: some.rule\n  enforcement: error\n\n# File B\n- id: some.rule\n  enforcement: warn  # CONFLICT after normalization -> ERROR\n"
    },
    "cross_reference_patterns": {
      "governance_statement": "cross_reference:\n  role: \"governance_statement\"\n  related_file: \".intent/charter/standards/operations/code_execution.yaml\"\n  related_rule_id: \"agent.execution.no_unverified_code\"\n  note: \"Technical specification is defined in code_execution.yaml\"\n",
      "implementation_detail": "cross_reference:\n  role: \"implementation_detail\"\n  related_file: \".intent/charter/standards/architecture/agent_governance.yaml\"\n  related_rule_id: \"agent.execution.no_unverified_code\"\n  note: \"Governance intent is defined in agent_governance.yaml\"\n",
      "canonical_definition": "canonical_definition: true\n"
    },
    "partial_enforcement": "- id: vector.sync_integrity\n  statement: \"No orphaned vectors or dangling links\"\n  enforcement: error\n  enforcement_aspects:\n    - name: \"orphaned_vectors\"\n      status: \"enforced\"\n      checker: \"VectorSyncCheck\"\n      evidence: \"Dry-run sync compares Qdrant IDs to DB links\"\n    - name: \"dangling_db_links\"\n      status: \"not_implemented\"\n      reason: \"Need bidirectional reference checker in DB layer\"\n"
  },
  "metadata": {
    "status": "active",
    "effective_date": "2025-12-18",
    "migration_notes": "Converted from legacy nested format to flat rules structure v2.0.0"
  },
  "additionalProperties": false
}
