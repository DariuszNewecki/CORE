# .intent/policies/secrets_management.yaml
#
# PURPOSE: This policy governs the handling of secrets, API keys, and
# other sensitive credentials within the CORE system and any applications
# it generates.

rules:
  - id: no_hardcoded_secrets
    description: >
      Source code MUST NOT contain hardcoded secrets (e.g., API keys, passwords).
      Secrets must be loaded from environment variables or a secure vault,
      as declared in runtime_requirements.yaml.
    enforcement: hard
    detection:
      type: regex
      patterns:
        - "(?i)api_key\\s*=\\s*[\"'](?!your_api_key_here)[a-zA-Z0-9_]{16,}"
        - "(?i)secret\\s*=\\s*[\"'][a-zA-Z0-9_]{16,}"
        - "(?i)password\\s*=\\s*[\"'][a-zA-Z0-9_]{8,}"
      exclude:
        # Allow examples in documentation and config templates
        - "*.md"
        - ".env.example"