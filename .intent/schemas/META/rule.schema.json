{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "schema_id": "schema.rule",
  "version": "2.0.0",
  "title": "CORE Rule Schema",
  "description": "The machine-level enforcer of a single rule. Validates that every law has a unique ID, a rationale, and a mandatory execution engine.",
  "type": "object",
  "required": [
    "id",
    "enforcement",
    "statement",
    "rationale",
    "check"
  ],
  "properties": {
    "id": {
      "type": "string",
      "pattern": "^[a-z][a-z0-9_]*(\\.[a-z0-9_]+)*$",
      "description": "Unique identifier using snake_case segments separated by dots."
    },
    "enforcement": {
      "type": "string",
      "enum": ["error", "warn", "warning", "info"],
      "description": "The weight of the law. 'error' blocks system operations."
    },
    "statement": {
      "type": "string",
      "minLength": 10,
      "maxLength": 500,
      "description": "The imperative command (formerly description)."
    },
    "rationale": {
      "type": "string",
      "minLength": 10,
      "description": "The 'Why' - critical for LLM reasoning and human audit."
    },
    "check": {
      "type": "object",
      "description": "Deterministic link to the execution engine.",
      "required": ["engine"],
      "properties": {
        "engine": {
          "type": "string",
          "enum": ["ast_gate", "regex_gate", "glob_gate", "python_handler", "llm_gate"],
          "description": "The specialized logic provider in CORE."
        },
        "params": {
          "type": "object",
          "description": "Parameters for the engine (e.g. forbidden_calls, patterns, or handler_id)."
        }
      },
      "additionalProperties": false
    },
    "category": {
      "type": "string",
      "pattern": "^[a-z][a-z0-9_]*$"
    },
    "subcategory": {
      "type": "string",
      "pattern": "^[a-z][a-z0-9_]*$"
    },
    "scope": {
      "oneOf": [
        { "type": "string" },
        { "type": "array", "items": { "type": "string" } }
      ]
    },
    "exceptions": {
      "type": "array",
      "items": { "type": "string" }
    },
    "owner": {
      "type": "string"
    },
    "notes": {
      "type": "string"
    }
  },
  "additionalProperties": false,
  "id": "rule.schema",
  "owners": {
    "accountable": "Governance Lead"
  },
  "review": {
    "frequency": "12 months"
  }
}
