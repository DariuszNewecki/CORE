# pyproject.toml

[build-system]
# This part is correct: it tells Python to use Poetry to build the project.
requires = ["poetry-core>=1.0.0"]
build-backend = "poetry.core.masonry.api"

# --- Poetry Project Metadata ---
# This [tool.poetry] section replaces the old [project] section.
# Poetry uses this to manage dependencies and package details.
[tool.poetry]
name = "core"
version = "0.1.0"
description = "CORE: A self-governing, intent-driven software development system."
authors = ["Dariusz Newecki <d.newecki@gmail.com>"]
license = "MIT"
readme = "README.md"
# --- MODIFICATION: Include all packages from the 'src' directory ---
packages = [
    { include = "core", from = "src" },
    { include = "agents", from = "src" },
    { include = "system", from = "src" },
    { include = "shared", from = "src" },
]

# --- Main Dependencies ---
# This replaces the old [project].dependencies array.
[tool.poetry.dependencies]
python = ">=3.9"
fastapi = ">=0.95.0"
uvicorn = ">=0.21.0"
pyyaml = ">=6.0"
requests = ">=2.28.0"
# --- THIS IS THE FIX ---
# We are adding 'httpx' which is an asynchronous HTTP client.
httpx = ">=0.25.0"
python-dotenv = ">=1.0.0"
pydantic = ">=2.0.0"
# --- ADDITION: Centralized settings management ---
pydantic-settings = "^2.0.0" 
cryptography = ">=42.0.0"
rich = "^13"
black = "^24"
jsonschema = "^4"
# --- ADDITION: A powerful CLI library ---
typer = {extras = ["rich"], version = "^0.9.0"}

# --- Development Dependencies ---
# This replaces the old [project.optional-dependencies].
# All dev/test tools go here. You install them with `poetry install --with dev`.
[tool.poetry.group.dev.dependencies]
pytest = ">=7.0,<8.0" # Pinned to avoid the conflict we saw
pytest-asyncio = "==0.21.0" # Pinned to the version we know works
ruff = ">=0.0.254"

# --- Command-Line Scripts ---
# This replaces the old [project.scripts] section.
# We will update this in a later step.
[tool.poetry.scripts]
core-admin = "system.admin_cli:app"

# --- Configuration for development tools (These do not change) ---
[tool.ruff]
line-length = 88
select = ["E", "W", "F", "I"]

[tool.pytest.ini_options]
testpaths = ["tests"]
asyncio_mode = "auto"
pythonpath = ["src"]
addopts = ["-c", "pyproject.toml"]
