# pyproject.toml
[build-system]
requires = ["poetry-core>=1.0.0"]
build-backend = "poetry.core.masonry.api"

[tool.poetry]
name = "core"
version = "0.1.0"
description = "CORE: A self-governing, intent-driven software development system."
authors = ["Dariusz Newecki <d.newecki@gmail.com>"]
license = "MIT"
readme = "README.md"
packages = [
    { include = "api", from = "src" },
    { include = "cli", from = "src" },
    { include = "core", from = "src" },
    { include = "features", from = "src" },
    { include = "services", from = "src" },
    { include = "shared", from = "src" },
]

[tool.poetry.dependencies]
python = ">=3.12"
fastapi = ">=0.95.0"
uvicorn = {extras = ["standard"], version = ">=0.21.0"}
pyyaml = ">=6.0"
httpx = ">=0.25.0"
python-dotenv = ">=1.0.0"
pydantic = ">=2.11"
pydantic-settings = "^2.10.1"
cryptography = ">=42.0.0"
rich = "^13"
black = "^24"
jsonschema = "^4"
typer = {extras = ["rich"], version = "^0.16.1"}
radon = ">=5.1.0"
filelock = "^3.13.0"
ruamel-yaml = "^0.18.6"
qdrant-client = "^1.9.2"
numpy = "^2.3.2"
scikit-learn = "^1.5.1"
scipy = "^1.14.0"
sqlalchemy = ">=2.0"
asyncpg = "^0.30.0"
sqlparse = "^0.5.3"

[tool.poetry.group.dev.dependencies]
pytest = ">=7.0,<8.0"
pytest-asyncio = "==0.21.0"
pytest-mock = "^3.12.0"
pytest-cov = "^6.2"
pytest-dotenv = "^0.5.2"

[tool.poetry.scripts]
core-admin = "cli.admin_cli:app"

[tool.black]
line-length = 88

[tool.ruff]
line-length = 88

[tool.ruff.lint]
select = ["E", "W", "F", "I"]
ignore = ["E402", "E501"]

[tool.pytest.ini_options]
testpaths = ["tests"]
asyncio_mode = "auto"
# --- START OF FIX ---
# This line tells pytest to add the 'src' directory to the Python path
# so that imports like 'from core.knowledge_service' work correctly.
pythonpath = ["src"]
# --- END OF FIX ---
addopts = ["-c", "pyproject.toml"]
env_files = [
    ".env"
]